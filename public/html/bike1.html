<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Bike 360</title>
    <link rel="stylesheet" type="text/css" href="../styles/video.css">
        <script src="https://aframe.io/releases/1.1.0/aframe.min.js"></script>

</head>
<body>
    <header>
            <iframe id="video" src="https://www.youtube.com/embed/Lg6YYMZzxVk?enablejsapi=1&html5=1&controls=0&showinfo=0&autoplay=1&rel=0" 
            frameborder="0" rotation="0 90 0" allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" allowfullscreen></iframe>
            <p id="overlayDesktop" style="z-index: 0; text-align: center; font-size: 20px;">
                Gire a tela para uma melhor experiência
            </p>
            <section class="rectangle"> 
                    <a href="bike.html"> <button id="overlayDesktop" style="z-index: 0; text-align: center;"> <img class="icons" src="../icons/return.svg" title="RETORNAR"></button></a>
                    <a href="bike.html"> <button class="overlayMobile" class="buttons"> <img class="icons" src="../icons/return.svg" title="RETORNAR"></button></a>
                    <button  id="play-button" class="overlayMobile"><img class="icons" src="../icons/play.svg" title="REPRODUZIR"></button>
                    <button  id="pause-button" class="overlayMobile"><img class="icons" src="../icons/pause.svg" title="PAUSAR"></button>
                    <button  id="stop-button" class="overlayMobile"><img class="icons" src="../icons/restart.svg" title="REINICIAR"></button>
                    <button  onclick="getPlayVelocity()" type="button" class="overlayMobile"><img class="icons" src="../icons/velocity.svg" title="VELOCIDADE"></button>
                    <button  onclick="setPlaySlow()" type="button" class="overlayMobile"><img class="icons" src="../icons/turtle.svg" title="LENTO"></button>
                    <button  onclick="setPlayFast()" type="button" class="overlayMobile"><img class="icons" src="../icons/fast.svg" title="RÁPIDO"></button>
                    <a href="bike2.html"><button class="overlayMobile"><img class="icons" src="../icons/next.svg" title="PRÓXIMO VÍDEO"></button></a>
                    <!--<button onclick= "openFullscreen();" id="overlayDesktop" style="z-index: 0; text-align: center;"><img class="icons" src="../icons/full-screen.svg" title="FULLSCREEN"></button>
                    <button onclick="start()">Start</button>
                    <button class= "buttons" onclick="setPlayNormal()" type="button">1.0x</button><br> -->
                </section>

            <script>
        
                //Injetar script da API do YouTube
                var tag = document.createElement('script');
                tag.src = "https://www.youtube.com/player_api";
                var firstScriptTag = document.getElementsByTagName('script')[0];
                firstScriptTag.parentNode.insertBefore(tag, firstScriptTag);
                //Variável global
                var player;
                //Essa função é chamada quando a API está pronta para uso
                function onYouTubePlayerAPIReady() {
                    //crie o player global a partir do iframe específico (#video)
                    player = new YT.Player('video', {
                        events: {
                            //Chame esta função quando o player estiver pronto para usar
                            'onReady': onPlayerReady
                        }
                    });
                }
                function onPlayerReady(event) {
                    //Eventos de ligação
                    var playButton = document.getElementById("play-button");
                    playButton.addEventListener("click", function() {
                        player.playVideo();
                    });
                    var pauseButton = document.getElementById("pause-button");
                    pauseButton.addEventListener("click", function() {
                        player.pauseVideo();
                    });
                    var stopButton = document.getElementById("stop-button");
                    stopButton.addEventListener("click", function() {
                        player.stopVideo();
                    });
                }
                    function getPlayVelocity() {   
                        alert("Sua velocidade é " + player.getPlaybackRate());
                        console.log(player.getPlaybackRate()); 
                    } 
                    function setPlaySlow() { 
                        let playRate = player.getPlaybackRate() > 0.5? player.getPlaybackRate()/2:  0.5; 
                        player.setPlaybackRate(playRate);
                    } 
                    function setPlayFast(){
                        let playRate =  player.getPlaybackRate()+0.5; 
                        player.setPlaybackRate(playRate);
                    }
                    function setPlayNormal(){
                        let playRate = 1.0;
                        player.setPlaybackRate(playRate);
                    }
                //teste de fuhnção para expandir 
                function ready() {
                    const { type } = screen.orientation;
                    console.log(`Fullscreen and locked to ${type}. Ready!`);
                }
                //screen.lockOrientation('landscape');
                async function start() {
                    await document.body.requestFullscreen();
                    await screen.orientation.lock("landscape");
                    ready();
                }

                //Function fullscreen
             var elem = document.getElementById("video");
                function openFullscreen() {
                    if (elem.requestFullscreen) {
                        elem.requestFullscreen();
                    // Safari 
                    } else if (elem.webkitRequestFullscreen) { 
                        elem.webkitRequestFullscreen();
                    // IE11
                    } else if (elem.msRequestFullscreen) { 
                        elem.msRequestFullscreen();
                    }
                }
               
                function browserSupports360 () {
                // YouTube supports 360 videos in a limited set of browsers,
                // see https://support.google.com/youtube/answer/6178631

                var ua = navigator.userAgent;

                // No mobile browser is supported at the moment
                if (/Mobile/.test(ua) || /Tablet/.test(ua)) return false;

                // Chrome >= 40
                if (/Chrome\/[^123][0-9]/.test(ua) && !/Edge\//.test(ua) && !/OPR\//.test(ua)) return true;

                // Firefox >= 40
                if (/Firefox\/[^123][0-9]/.test(ua)) return true;

                // Microsoft Edge
                if (/Edge\//.test(ua)) return true;

                // Opera >= 30
                if (/OPR\/[^12][0-9]/.test(ua)) return true;

                return false;
                }

            </script>
        </header>
</body>
</html>